<!DOCTYPE module SYSTEM "module.dtd">

<module name="ObstacleAvoidSkySegmentation">
  <doc>
    <description>Video ARDone 2</description>
  </doc>

  <header>
    <file name="video.h"/>
  </header>

  <init fun="video_init()"/>

  <periodic fun="video_receive()" freq="200" start="video_start()" stop="video_stop()" autorun="FALSE"/>
  <makefile>
    <define name="ARDRONE_VIDEO_PORT" value="2002" />
    <define name="USE_ARDRONE_VIDEO" />
<!--    <file name="video.c"/>  -->
      <raw>

VISION_FOLDER = $(PAPARAZZI_HOME)/sw/ext/ardrone2_vision/modules/ObstacleAvoidSkySegmentation
          
$(TARGET).srcs += $(VISION_FOLDER)/obstacle_avoid.c
$(TARGET).srcs += $(VISION_FOLDER)/avoid_navigation.c
$(TARGET).srcs += $(PAPARAZZI_HOME)/sw/ext/ardrone2_vision/gst_plugin_framework/socket.c
$(TARGET).CFLAGS += -I$(PAPARAZZI_HOME)/sw/ext/ardrone2_vision/modules
$(TARGET).LDFLAGS += -pthread

all:
	echo "Compiling libObstacleAvoidSkySegmentation.so plugin"
	sb2 make -C $(PAPARAZZI_HOME)/sw/ext/ardrone2_vision/pprz_gst_plugins/ObstacleAvoidSkySegmentation all
	make -C $(VISION_FOLDER)/visionresult/
	
upload_extra:
	@echo "====================================VISION UPLOAD======================================"
	make -C $(PAPARAZZI_HOME)/sw/ext/ardrone2_vision/pprz_gst_plugins/ObstacleAvoidSkySegmentation upload

    </raw>
  </makefile>
</module>

